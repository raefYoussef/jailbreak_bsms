{% extends "blank_template.html" %}
	
	{% block page_title %} Dashboard {% endblock %}
	
	{% block stylesheets %}
		<!-- Morris Charts CSS -->
    	<link href="{{url_for('static', filename='morrisjs/morris.css')}}" rel="stylesheet">

		<!-- DataTables CSS -->
		<link href="{{url_for('static', filename='DataTables/DataTables-1.10.13/css/dataTables.bootstrap.min.css')}}" rel="stylesheet">
		<link href="{{url_for('static', filename='DataTables/ColReorder-1.3.2/css/colReorder.bootstrap.min.css')}}" rel="stylesheet">
		<link href="{{url_for('static', filename='DataTables/FixedHeader-3.1.2/css/fixedHeader.bootstrap.min.css')}}" rel="stylesheet">
		<link href="{{url_for('static', filename='DataTables/Responsive-2.1.1/css/responsive.bootstrap.min.css')}}" rel="stylesheet">
		<link href="{{url_for('static', filename='DataTables/Scroller-1.4.2/css/scroller.bootstrap.min.css')}}" rel="stylesheet">
	{% endblock %}
	
	{% block account_name %} {{ account_name }} {% endblock %}
	
	{% block sidebar %}
		<li class="active">
			<a href="/dashboard/"><i class="fa fa-fw fa-dashboard"></i> Dashboard</a>
		</li>
		<li>
			<a href="/view_inventory/"><i class="fa fa-fw fa-table"></i> View Inventory</a>
		</li>
		<li>
			<a href="/edit_inventory/"><i class="fa fa-fw fa-edit"></i> Edit Inventory</a>
		</li>
		<li>
			<a href="/logistics/"><i class="fa fa-fw fa-bar-chart-o"></i> Logistics</a>
		</li>
	{% endblock %}

	{% block page_heading %} Dashboard {% endblock %}
	
	{% block page_subheading %} Overview {% endblock %}
	
	{% block breadcrumbs %}
		<li class="active">
			<i class="fa fa-dashboard"></i> Dashboard
		</li>
	{% endblock %}

	{% block alerts %}
		<div class="alert alert-danger alert-dismissable">
			<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
			<i class="fa fa-info-circle"></i>  <strong>Warning</strong> There were 2 failed signin attempts since the last successful signin
		</div>
	{% endblock %}

	{% block body %} 
		<!-- Overview Panels -->
		<div class="row">
			<div class="col-md-6 col-lg-3">
				<div class="panel panel-primary">
					<div class="panel-heading">
						<div class="row">
							<div class="col-xs-3">
								<i class="fa fa-truck fa-5x"></i>
							</div>
							<div class="col-xs-9 text-right">
								<div class="huge">26</div>
								<div>New Shipped Kegs!</div>
							</div>
						</div>
					</div>
					<a href="#">
						<div class="panel-footer">
							<span class="pull-left">View Details</span>
							<span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
							<div class="clearfix"></div>
						</div>
					</a>
				</div>
			</div>
			<div class="col-lg-3 col-md-6">
				<div class="panel panel-green">
					<div class="panel-heading">
						<div class="row">
							<div class="col-xs-3">
								<i class="fa fa-tint fa-5x"></i>
							</div>
							<div class="col-xs-9 text-right">
								<div class="huge">12</div>
								<div>New Filled Kegs!</div>
							</div>
						</div>
					</div>
					<a href="#">
						<div class="panel-footer">
							<span class="pull-left">View Details</span>
							<span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
							<div class="clearfix"></div>
						</div>
					</a>
				</div>
			</div>
			<div class="col-lg-3 col-md-6">
				<div class="panel panel-yellow">
					<div class="panel-heading">
						<div class="row">
							<div class="col-xs-3">
								<i class="fa fa-beer fa-5x"></i>
							</div>
							<div class="col-xs-9 text-right">
								<div class="huge">3</div>
								<div>New Kegs on Tap!</div>
							</div>
						</div>
					</div>
					<a href="#">
						<div class="panel-footer">
							<span class="pull-left">View Details</span>
							<span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
							<div class="clearfix"></div>
						</div>
					</a>
				</div>
			</div>
			<div class="col-lg-3 col-md-6">
				<div class="panel panel-red">
					<div class="panel-heading">
						<div class="row">
							<div class="col-xs-3">
								<i class="fa fa-plus-circle fa-5x"></i>
							</div>
							<div class="col-xs-9 text-right">
								<div class="huge">13</div>
								<div>New Added Kegs!</div>
							</div>
						</div>
					</div>
					<a href="#">
						<div class="panel-footer">
							<span class="pull-left">View Details</span>
							<span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
							<div class="clearfix"></div>
						</div>
					</a>
				</div>
			</div>
		</div>
		<!-- /.row -->

		<div class="row">
			<div class="col-lg-12">
				<div class="panel panel-default">
					<div class="panel-heading">
						<h3 class="panel-title"><i class="fa fa-line-chart fa-fw"></i> Keg Status</h3>
					</div>
					<div class="panel-body">
						<div id="dashboard_keg_status"></div>
					</div>
				</div>
			</div>
		</div>
		<!-- /.row -->

		<div class="row">
			<div class="col-lg-6">
				<div class="panel panel-default">
					<div class="panel-heading">
						<h3 class="panel-title"><i class="fa fa-pie-chart fa-fw"></i> Beer Brands</h3>
					</div>
					<div class="panel-body">
						<div id="dashboard_inventory_beers"></div>
					</div>
				</div>
			</div>

			<div class="col-lg-6">
				<div class="panel panel-default">
					<div class="panel-heading">
						<h3 class="panel-title"><i class="fa fa-users fa-fw"></i> Customers</h3>
					</div>
					<!-- /.panel-heading -->

					<div class="panel-body">
						<table width="100%" class="table table-bordered table-hover table-striped" id="customer_summary">
							<thead>
								<tr>
									<th>Customer</th>
									<th>Keg Count</th>
									<th>Last Activity</th>
								</tr>
							</thead>
							<tbody>
							</tbody>
						</table>
					</div>
					<!-- /.table-responsive -->
				</div>
			</div>
			<!-- /.col-lg-4 (nested) -->
		</div>

	{% endblock %}

	{% block scripts %}
		<!-- Morris Charts JavaScript -->
		<script src="{{url_for('static', filename='raphael/raphael.min.js')}}"></script>
		<script src="{{url_for('static', filename='morrisjs/morris.min.js')}}"></script>
		
		<!-- DataTables JavaScript -->
		<script src="{{url_for('static', filename='DataTables/DataTables-1.10.13/js/jquery.dataTables.min.js')}}"></script>
		<script src="{{url_for('static', filename='DataTables/DataTables-1.10.13/js/dataTables.bootstrap.min.js')}}"></script>
		<script src="{{url_for('static', filename='DataTables/ColReorder-1.3.2/js/dataTables.colReorder.min.js')}}"></script>
		<script src="{{url_for('static', filename='DataTables/FixedHeader-3.1.2/js/dataTables.fixedHeader.min.js')}}"></script>
		<script src="{{url_for('static', filename='DataTables/Responsive-2.1.1/js/dataTables.responsive.min.js')}}"></script>
		<script src="{{url_for('static', filename='DataTables/Responsive-2.1.1/js/responsive.bootstrap.min.js')}}"></script>
		<script src="{{url_for('static', filename='DataTables/Scroller-1.4.2/js/dataTables.scroller.min.js')}}"></script>

		<script>
		$(document).ready(function() {
			//  Custome Table
			var customers_table = $("#customer_summary").DataTable({
				"responsive": true,
				"searching": true,
				"order": [[2, "desc"]],
				"scrollY": "230px",
				"scrollCollapse": true,
				"paging": true
			});

			// customers_table.rows.add([["Greene Turtle",3,"2017-04-27 04:55:04"],["Tubbys Diner",1,"2017-04-27 00:35:07"]]).draw();
			// customers_table.rows.add([["Tiger Nixon","System Architect", "System Architect"],["Garrett Winters","Director", "$5,300"]]).draw();


			// Beer Brand Donut Chart
			var donut_chart = Morris.Donut({
				element: 'dashboard_inventory_beers',
				data: [{
					label: "Kegs on Tap or in Inventory",
					value: 0
				}],
				resize: true
			});

			// customers table ajax request
			$.ajax({
				url: "/dashboard_ajax_customers/",
				dataType: "json",
				type: "POST",
				success: function(response) {
					customers_table.clear();
					customers_table.rows.add(response);
					customers_table.draw();	
				},
				error: function(error) {
					console.log("Ajax Request Error - Customers Table");
				}
			});

			// beer brand chart ajax request
			$.ajax({
				url: "/dashboard_ajax_brands/",
				dataType: "json",
				type: "POST",
				success: function(response) {
					console.log(response);

					if(response["brands_chart"].length != 0)
					{
						// there exist kegs on tap or in inventory
						donut_chart.setData(response["brands_chart"]);
					}
					else
					{
						donut_chart.setData({label: "Kegs on Tap or in Inventory", value: 0 });
					}
				},
				error: function(error) {
					console.log("Ajax Request Error - Beer Brands Chart");
				}
			});

			// Keg Status Line Chart
			Morris.Line({
			    element: 'dashboard_keg_status',
			    data: [{
			        date: '2017-03-26',
			        dirty: 100,
			        clean: 40,
			        full_out: 150,
			        full_tap: 10,
			        full_inv: 50 
			    }, {
			        date: '2017-03-27',
			        dirty: 80,
			        clean: 45,
			        full_out: 155,
			        full_tap: 10,
			        full_inv: 60
			    }, {
			        date: '2017-03-28',
			        dirty: 90,
			        clean: 40,
			        full_out: 135,
			        full_tap: 10,
			        full_inv: 70
			    }, {
			        date: '2017-03-29',
			        dirty: 70,
			        clean: 50,
			        full_out: 135,
			        full_tap: 15,
			        full_inv: 75
			    }, {
			        date: '2017-03-30',
			        dirty: 75,
			        clean: 55,
			        full_out: 115,
			        full_tap: 15,
			        full_inv: 85
			    }, {
			        date: '2017-03-31',
			        dirty: 55,
			        clean: 65,
			        full_out: 115,
			        full_tap: 15,
			        full_inv: 95
			    }, {
			        date: '2017-04-01',
			        dirty: 55,
			        clean: 65,
			        full_out: 135,
			        full_tap: 10,
			        full_inv: 80
			    }],
			    xkey: 'date',
			    ykeys: ['dirty', 'clean', 'full_out', 'full_tap', 'full_inv'],
			    labels: ['Dirty', 'Clean', 'Full (Out)', 'Full (Tap)', 'Full (Inventory)'],
			    lineColors: ['#DCA525', '#076BB6', '#E66665', '#AE70AF', '#9ECEB4'],
			    pointSize: 4,
			    resize: true,
			    hideHover: 'auto'
			});
		});
		</script>
	{% endblock %}

